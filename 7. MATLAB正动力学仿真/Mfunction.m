function [ Mq ] = Mfunction( x )
global mbody mthigh mshank mfoot;
global Ibody Ithigh Ishank Ifoot;
global lt1 lt2 ls1 ls2 lf1 lf2;
global llb llt1 llt2 lls1 lls2;
global rf;
a1=x(3);
a2=x(4);
a3=x(5);
a11=x(6);
a22=x(7);
b1=x(8);
b2=x(9);
Mq=[mbody+2.*mfoot+2.*mshank+2.*mthigh,0,lt1.*mfoot.*cos(a1)+lt1.*mshank.* ...
  cos(a1)+llt1.*mthigh.*cos(a1),lt2.*mfoot.*cos(a2)+lt2.*mshank.*cos(a2)+ ...
  llt2.*mthigh.*cos(a2),(-1).*llb.*mbody.*cos(a3),ls1.*mfoot.*cos(a11)+ ...
  lls1.*mshank.*cos(a11),ls2.*mfoot.*cos(a22)+lls2.*mshank.*cos(a22), ...
  mfoot.*((-1/2).*lf1.*sin(b1)+lf1.*rf.*sin(b1)),mfoot.*((-1/2).*lf2.*sin( ...
  b2)+lf2.*rf.*sin(b2));0,mbody+2.*mfoot+2.*mshank+2.*mthigh,lt1.*mfoot.* ...
  sin(a1)+lt1.*mshank.*sin(a1)+llt1.*mthigh.*sin(a1),lt2.*mfoot.*sin(a2)+ ...
  lt2.*mshank.*sin(a2)+llt2.*mthigh.*sin(a2),(-1).*llb.*mbody.*sin(a3), ...
  ls1.*mfoot.*sin(a11)+lls1.*mshank.*sin(a11),ls2.*mfoot.*sin(a22)+lls2.* ...
  mshank.*sin(a22),mfoot.*((1/2).*lf1.*cos(b1)+(-1).*lf1.*rf.*cos(b1)), ...
  mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.*rf.*cos(b2));
  lt1.*mfoot.*cos(a1)+ ...
  lt1.*mshank.*cos(a1)+llt1.*mthigh.*cos(a1),lt1.*mfoot.*sin(a1)+lt1.* ...
  mshank.*sin(a1)+llt1.*mthigh.*sin(a1),Ithigh+lt1.^2.*mfoot.*cos(a1).^2+ ...
  lt1.^2.*mshank.*cos(a1).^2+llt1.^2.*mthigh.*cos(a1).^2+lt1.^2.*mfoot.* ...
  sin(a1).^2+lt1.^2.*mshank.*sin(a1).^2+llt1.^2.*mthigh.*sin(a1).^2,0,0, ...
  ls1.*lt1.*mfoot.*cos(a1).*cos(a11)+lls1.*lt1.*mshank.*cos(a1).*cos(a11)+ ...
  ls1.*lt1.*mfoot.*sin(a1).*sin(a11)+lls1.*lt1.*mshank.*sin(a1).*sin(a11), ...
  0,lt1.*mfoot.*((1/2).*lf1.*cos(b1)+(-1).*lf1.*rf.*cos(b1)).*sin(a1)+ ...
  lt1.*mfoot.*cos(a1).*((-1/2).*lf1.*sin(b1)+lf1.*rf.*sin(b1)),0;
  lt2.* ...
  mfoot.*cos(a2)+lt2.*mshank.*cos(a2)+llt2.*mthigh.*cos(a2),lt2.*mfoot.* ...
  sin(a2)+lt2.*mshank.*sin(a2)+llt2.*mthigh.*sin(a2),0,Ithigh+lt2.^2.* ...
  mfoot.*cos(a2).^2+lt2.^2.*mshank.*cos(a2).^2+llt2.^2.*mthigh.*cos(a2) ...
  .^2+lt2.^2.*mfoot.*sin(a2).^2+lt2.^2.*mshank.*sin(a2).^2+llt2.^2.* ...
  mthigh.*sin(a2).^2,0,0,ls2.*lt2.*mfoot.*cos(a2).*cos(a22)+lls2.*lt2.* ...
  mshank.*cos(a2).*cos(a22)+ls2.*lt2.*mfoot.*sin(a2).*sin(a22)+lls2.*lt2.* ...
  mshank.*sin(a2).*sin(a22),0,lt2.*mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.* ...
  rf.*cos(b2)).*sin(a2)+lt2.*mfoot.*cos(a2).*((-1/2).*lf2.*sin(b2)+lf2.* ...
  rf.*sin(b2));
  (-1).*llb.*mbody.*cos(a3),(-1).*llb.*mbody.*sin(a3),0,0, ...
  Ibody+llb.^2.*mbody.*cos(a3).^2+llb.^2.*mbody.*sin(a3).^2,0,0,0,0;
  ls1.*mfoot.*cos(a11)+lls1.*mshank.*cos(a11),ls1.*mfoot.*sin(a11)+lls1.* ...
  mshank.*sin(a11),ls1.*lt1.*mfoot.*cos(a1).*cos(a11)+lls1.*lt1.*mshank.* ...
  cos(a1).*cos(a11)+ls1.*lt1.*mfoot.*sin(a1).*sin(a11)+lls1.*lt1.*mshank.* ...
  sin(a1).*sin(a11),0,0,Ishank+ls1.^2.*mfoot.*cos(a11).^2+lls1.^2.* ...
  mshank.*cos(a11).^2+ls1.^2.*mfoot.*sin(a11).^2+lls1.^2.*mshank.*sin(a11) ...
  .^2,0,ls1.*mfoot.*((1/2).*lf1.*cos(b1)+(-1).*lf1.*rf.*cos(b1)).*sin(a11)+...
  ls1.*mfoot.*cos(a11).*((-1/2).*lf1.*sin(b1)+lf1.*rf.*sin(b1)),0;
  ls2.*mfoot.*cos(a22)+lls2.*mshank.*cos(a22),ls2.*mfoot.*sin(a22)+lls2.* ...
  mshank.*sin(a22),0,ls2.*lt2.*mfoot.*cos(a2).*cos(a22)+lls2.*lt2.* ...
  mshank.*cos(a2).*cos(a22)+ls2.*lt2.*mfoot.*sin(a2).*sin(a22)+lls2.*lt2.* ...
  mshank.*sin(a2).*sin(a22),0,0,Ishank+ls2.^2.*mfoot.*cos(a22).^2+ ...
  lls2.^2.*mshank.*cos(a22).^2+ls2.^2.*mfoot.*sin(a22).^2+lls2.^2.* ...
  mshank.*sin(a22).^2,0,ls2.*mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.*rf.* ...
  cos(b2)).*sin(a22)+ls2.*mfoot.*cos(a22).*((-1/2).*lf2.*sin(b2)+lf2.*rf.* ...
  sin(b2));
  mfoot.*((-1/2).*lf1.*sin(b1)+lf1.*rf.*sin(b1)),mfoot.*((1/2).* ...
  lf1.*cos(b1)+(-1).*lf1.*rf.*cos(b1)),lt1.*mfoot.*((1/2).*lf1.*cos(b1)+( ...
  -1).*lf1.*rf.*cos(b1)).*sin(a1)+lt1.*mfoot.*cos(a1).*((-1/2).*lf1.*sin( ...
  b1)+lf1.*rf.*sin(b1)),0,0,ls1.*mfoot.*((1/2).*lf1.*cos(b1)+(-1).*lf1.* ...
  rf.*cos(b1)).*sin(a11)+ls1.*mfoot.*cos(a11).*((-1/2).*lf1.*sin(b1)+lf1.* ...
  rf.*sin(b1)),0,Ifoot+mfoot.*((1/2).*lf1.*cos(b1)+(-1).*lf1.*rf.*cos(b1)) ...
  .^2+mfoot.*((-1/2).*lf1.*sin(b1)+lf1.*rf.*sin(b1)).^2,0;
  mfoot.*((-1/2).*lf2.*sin(b2)+lf2.*rf.*sin(b2)),mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.* ...
  rf.*cos(b2)),0,lt2.*mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.*rf.*cos(b2)) ...
  .*sin(a2)+lt2.*mfoot.*cos(a2).*((-1/2).*lf2.*sin(b2)+lf2.*rf.*sin(b2)), ...
  0,0,ls2.*mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.*rf.*cos(b2)).*sin(a22)+ ...
  ls2.*mfoot.*cos(a22).*((-1/2).*lf2.*sin(b2)+lf2.*rf.*sin(b2)),0,Ifoot+ ...
  mfoot.*((1/2).*lf2.*cos(b2)+(-1).*lf2.*rf.*cos(b2)).^2+mfoot.*((-1/2).* ...
  lf2.*sin(b2)+lf2.*rf.*sin(b2)).^2];


end

